<html>
<head>
    <title>CTIA Final Project</title>
    <style>
        body { margin: 0; background:#000; }
        canvas { width: 100%; height: 100% }
    </style>
</head>
<body>
<div id="container"></div>

<script src="libs/three.min.js"></script>
<script src="libs/TrackballControls.js"></script>
<script src="libs/stats.min.js"></script>
<script>

    var container, stats, camera, controls, scene, renderer;

    init();
    animate();

    function init() {

        /* Scene */
        scene = new THREE.Scene();
        scene.fog = new THREE.FogExp2( 0x000000, 0.002 );


        /* Renderer */
        renderer = new THREE.WebGLRenderer( { antialias: false } );
        renderer.setClearColor( scene.fog.color );
        renderer.setPixelRatio( window.devicePixelRatio );
        renderer.setSize( window.innerWidth, window.innerHeight );


        /* container */
        container = document.getElementById( 'container' );
        container.appendChild( renderer.domElement );

        /* camera */
        camera = new THREE.PerspectiveCamera( 60, window.innerWidth / window.innerHeight, 1, 1000 );
        camera.position.z = 100;
        camera.position.z = 40;


        /* OrbitControls */
        controls = new THREE.TrackballControls( camera );

//        controls.rotateSpeed = 1.0;
        controls.zoomSpeed = 1.2;
        controls.panSpeed = 1.2;

        controls.noZoom = false;
        controls.noPan = false;

        controls.staticMoving = true;
        controls.dynamicDampingFactor = 0.9;

        controls.keys = [ 65, 83, 68 ];

        controls.addEventListener( 'change', render );

        /* create Geometry */
        var dim = 16;
        var dimX = 1;
        var dimY = 1;
        var dimZ = 5;

        var geometry = new THREE.BoxGeometry( dimX, dimY, dimZ );
        for (var x = -dim/dimX; x < dim/dimX; x++) {
            for (var y = -dim/dimY; y < dim/dimY; y++) {
                for (var z = -dim/dimZ; z < dim/dimZ; z++) {
                    var r = Math.round(Math.random() * 0xff) * 0x010101;

                    if (Math.sqrt(Math.pow(x * dimX,2) + Math.pow(y * dimY,2) + Math.pow(z * dimZ,2)) < 8) {
                        r = 0xff0000;
                    } else {
//                    continue;
                        if (r < 0x555555) {
                            continue;
                        }
                        r = 0x999999;
                    }

                    var material = new THREE.MeshBasicMaterial({color: r});
//                var material = new THREE.MeshDepthMaterial({color: r});
                    if (r != 0xff0000) {
                        material.transparent = true;
                        material.opacity = Math.random() * 0.3;
                        material.side = THREE.doubleSided;
                    }
//                material.wireframe = true;

                    var cube = new THREE.Mesh(geometry, material);

//                console.log(material);

                    cube.position.x = x * dimX;
                    cube.position.y = y * dimY;
                    cube.position.z = z * dimZ;
                    scene.add(cube);
                }
            }
        }

        /* lights? */
        light = new THREE.DirectionalLight( 0xffffff );
        light.position.set( 1, 1, 1 );
        scene.add( light );

        light = new THREE.DirectionalLight( 0x002288 );
        light.position.set( -1, -1, -1 );
        scene.add( light );

        light = new THREE.AmbientLight( 0x222222 );
        scene.add( light );


        /* stats */
        stats = new Stats();
        stats.domElement.style.position = 'absolute';
        stats.domElement.style.top = '0px';
        stats.domElement.style.zIndex = 100;
        container.appendChild( stats.domElement );

    }


    /* resizing stuff */
    function onWindowResize() {

        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();

        renderer.setSize( window.innerWidth, window.innerHeight );

        controls.handleResize();

        render();

    }
    window.addEventListener( 'resize', onWindowResize, false );

    /* Render loop */
    function render() {
        renderer.render(scene, camera);
        stats.update();
    }

    /* animation kickoff */
    function animate() {
        render();
        requestAnimationFrame( animate );
        controls.update();

    }


</script>
</body>
</html>